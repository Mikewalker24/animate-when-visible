"use strict";module.exports=function(e={}){const t={threshold:.1,staggerDelay:100,staggerDelaySlow:250,animationClass:"awv-visible",staggerClass:"awv-stagger",staggerSlowClass:"awv-stagger-slow",targetSelector:".awv-animate",staggerContainerSelector:".awv-stagger-container",onVisible:null,observeMutations:!0,animateOnScrollDownOnly:!1,...e},s=new Map;let o=0;const n=new Map;let a=window.scrollY;const r=new IntersectionObserver(e=>{const o=window.scrollY,l=o>a;a=o,e.filter(e=>e.isIntersecting).sort((e,t)=>s.get(e.target)-s.get(t.target)).forEach(e=>{if(t.animateOnScrollDownOnly&&!l)return;const s=e.target,o=s.closest(t.staggerContainerSelector)||s.closest("section")||s.closest("nav")||document.body;n.has(o)||n.set(o,0);const a=n.get(o),c=o.querySelectorAll(`.${t.animationClass}`).length,i=s.classList.contains(t.staggerSlowClass)?(a-c)*t.staggerDelaySlow+"ms":s.classList.contains(t.staggerClass)?(a-c)*t.staggerDelay+"ms":"0ms";requestAnimationFrame(()=>{s.style.transitionDelay=i,s.classList.add(t.animationClass),s.addEventListener("transitionend",()=>s.style.transitionDelay="0ms",{once:!0}),"function"==typeof t.onVisible&&t.onVisible(s)}),n.set(o,a+1),r.unobserve(s)})},{threshold:t.threshold}),l=e=>{e.forEach(e=>{s.has(e)||s.set(e,o++),r.observe(e)})};let c;return l(document.querySelectorAll(t.targetSelector)),t.observeMutations&&(c=new MutationObserver(e=>{const s=[];e.forEach(e=>e.addedNodes.forEach(e=>{1===e.nodeType&&(e.matches(t.targetSelector)?s.push(e):s.push(...e.querySelectorAll(t.targetSelector)))})),s.length&&l(s)}),c.observe(document.body,{childList:!0,subtree:!0})),{destroy(){r.disconnect(),c&&c.disconnect()},refresh(){l(document.querySelectorAll(t.targetSelector))}}};
